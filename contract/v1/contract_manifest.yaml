contract:
  name: "AI Legal Service Contract"
  version: "v1"
  status: "authoritative"
  ssot_rules:
    - "Contract v1 text supersedes all visuals."
    - "Only files enumerated in this manifest are authoritative for v1."
    - "Any duplicate/alternate copies are non-authoritative and must be removed or replaced with stub pointers."
    - "All case data is case-scoped; cross-case access is prohibited unless explicitly mediated and audited."
    
  harness:
    contract: "./harness/harness_contract.md"
    sample_tool_request: "./harness/sample_payloads/tool_request.json"
    run_harness_script: "./harness/run_harness.py"

  governance:
    owners:
      - role: "SystemOwner"
        description: "Maintains the contract, schemas, and enforcement rules."
      - role: "Attorney"
        description: "Owns case decisions, approvals, and case-instance taxonomies."
    references:
      roles: "./policy/roles.yaml"
      lanes: "./policy/lanes.yaml"
      policy_versioning: "./policy/policy_versioning.md"
      taxonomy_versioning: "./taxonomies/taxonomy_versioning.md"

  authoritative_files:
    architecture:
      - "./architecture/section7-layered-architecture.md"
    orchestration:
      - "./orchestration/orchestrator_contract.md"
    execution:
      - "./execution/run_lifecycle.md"
      - "./execution/run_status_model.md"
    tools:
      - "./tools/tool_registry.yaml"
      - "./tools/tool_gateway_contract.md"
    schemas:
      - "./schemas/run_record.schema.yaml"
      - "./schemas/audit_event.schema.yaml"
      - "./schemas/artifact_ref.schema.yaml"
      - "./schemas/export_bundle.schema.yaml"
    data:
      - "./data/postgres_ddl.sql"
      - "./data/postgres_seed.sql"
      - "./data/data_model_mappings.md"
    agent_contracts:
      - "./agents/agent_interface_contract.md"
    taxonomies:
      coa:
        - "./taxonomies/coa/base_coa_v1.yaml"
      entities:
        - "./taxonomies/entities/entity_schema_v1.yaml"
      tags:
        - "./taxonomies/tags/tag_schema_v1.yaml"

  invariants:
    - id: "INV-CASE-ISOLATION"
      statement: "All runs, artifacts, and events must be bound to a Case_UID; cross-case joins require explicit mediation and audit logging."
    - id: "INV-AUDITABILITY"
      statement: "All tool calls and material transformations must emit audit_event records."
    - id: "INV-DETERMINISM"
      statement: "Given identical inputs + taxonomy versions + tool registry + model settings, the run must be reproducible within defined tolerances."
    - id: "INV-GOVERNED-CHANGES"
      statement: "Taxonomy and policy changes require version bumps and traceable approvals per policy_versioning.md and taxonomy_versioning.md."
    - id: "INV-TOOL-MEDIATION"
      statement: "Agents cannot call external tools directly; all tool access must be mediated via the tool gateway contract."

  semantic_validation:
    acceptance_checklist: "./acceptance/semantic_validation_checklist.md"
    required_outcomes:
      - "No duplicate authoritative documents (SSOT enforced)."
      - "Orchestrator references all required schemas and lifecycle artifacts."
      - "Roles/lanes align to tool permissions and taxonomy write boundaries."
      - "Taxonomy stubs exist and are versioned; case-instance overlay defined."
integrity:
  file_hashes:
    enabled: true
    algorithm: "sha256"
    hashes:
      "./agents/agent_interface_contract.md": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
      "./architecture/section7-layered-architecture.md": "2c5a9d4f85b5593abc2993e41613e80d83dcd9cd0b0f03dd4f418e4a7bef602e"
      "./data/data_model_mappings.md": "89698a88d1358e7a5a9015dc147d6d0b1c3f25fc70960337cc82c503c9b1ab01"
      "./data/postgres_ddl.sql": "816ec94992c5e56b92a3997149d56e09d1414813b5a40398f53099a27dffc333"
      "./data/postgres_seed.sql": "da88cb89538b2cf8a501fad0f57b18479ace8f04d229cddd3d3011f557c1edda"
      "./execution/run_lifecycle.md": "4321997d64ee504b7c999bba3db195d6202f9a3dbb0efb92d9c1f793e70bafa0"
      "./execution/run_status_model.md": "93aeecba8c6f74b46dd877743f47067246440d52cdf202dbbd953e14543795b3"
      "./orchestration/orchestrator_contract.md": "1e08dfbee0b31a807ceb1ef2d35b0ab99f8e4249d84f9358d8298a5ceaa4f536"
      "./schemas/artifact_ref.schema.yaml": "11e8ab7ab406de6a85420ecd9066e5bf6aca49ffb9ce9fc12d0972a963501fec"
      "./schemas/audit_event.schema.yaml": "0e5e66a29d8a9f86f8c2e96adf396ec0b46021edf8fe7424a17af1c91925a334"
      "./schemas/export_bundle.schema.yaml": "8d6befdd95b847943ef2aae71e9b9f97d5b1a375c97beae20ffb50b76886615c"
      "./schemas/run_record.schema.yaml": "670d9ca8733263193ddccfbecdf145e4476739d7e35122d329a7126aa87b3394"
      "./taxonomies/coa/base_coa_v1.yaml": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
      "./taxonomies/entities/entity_schema_v1.yaml": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
      "./taxonomies/tags/tag_schema_v1.yaml": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
      "./tools/tool_gateway_contract.md": "8b47ca97a7e1ea5f0d16b9705d1748f0fbc324dc10dedc6eaed0cf55f85c63cf"
      "./tools/tool_registry.yaml": "d42c1ba40ecde605260b9ec387d472f072e222e012ed48f8074c61239e08fd67"
      "./agents/agent_COA_REASONER.md": "60855c247b835a56bfadef34774cecc9af6589c4da144c0824977307084011cb"

- path: contract/v1/acceptance/build_integrity_checklist.md
  sha256: f562ef20627cd5e2a9a05b43e0e8f97c1e02c274bec7db215404dfe83a2906f1


# Stage 11 — Orchestration SSOT
# How does execution flow?
- ./orchestration/rerun_levels.yaml
- ./orchestration/state_machine.yaml
- ./orchestration/approval_gates.yaml
- ./orchestration/invalidation_graph.yaml

# Stage 12 — Determinism Integrity SSOT
# How is determinism guaranteed?
- ./orchestration/run_identity_fingerprints.yaml
- ./orchestration/determinism_integrity_contract.md

# Stage 13 — Replay Harness Enforcement SSOT
# How is determinism verifiably replayable?
- ./harness/replay_vectors/REPLAY_VECTOR_SPEC.md
- ./harness/replay_vectors/minimal_vector.json
